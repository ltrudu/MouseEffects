<UserControl x:Class="MouseEffects.Effects.ColorBlindness.UI.ColorBlindnessSettingsControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:local="clr-namespace:MouseEffects.Effects.ColorBlindness.UI"
             mc:Ignorable="d" d:DesignWidth="320">
    <UserControl.Resources>
        <Style TargetType="TextBlock" x:Key="LabelStyle">
            <Setter Property="Margin" Value="0,8,0,4"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
        </Style>
        <Style TargetType="Slider" x:Key="SliderStyle">
            <Setter Property="Margin" Value="0,0,0,4"/>
        </Style>
        <Style TargetType="TextBlock" x:Key="SectionStyle">
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Margin" Value="0,0,0,8"/>
        </Style>
        <Style TargetType="TextBlock" x:Key="ZoneHeaderStyle">
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Margin" Value="0,8,0,4"/>
            <Setter Property="Foreground" Value="#FF3399FF"/>
        </Style>
    </UserControl.Resources>

    <StackPanel Margin="0">
        <!-- Header Row: Enabled checkbox | Title | Fold/Unfold button -->
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <CheckBox x:Name="EnabledCheckBox" Content="Enabled" Grid.Column="0"
                      VerticalAlignment="Center"
                      IsChecked="True" Checked="EnabledCheckBox_Changed" Unchecked="EnabledCheckBox_Changed"/>

            <TextBlock Text="Color Blindness" Grid.Column="1"
                       FontWeight="Bold" FontSize="14"
                       VerticalAlignment="Center" HorizontalAlignment="Right" Margin="0,0,8,0"/>

            <Button x:Name="FoldButton" Grid.Column="2"
                    Content="â–¼" Width="24" Height="24"
                    Background="Transparent" BorderThickness="0"
                    Click="FoldButton_Click" ToolTip="Expand/Collapse settings"/>
        </Grid>

        <!-- Description (always visible) -->
        <TextBlock Text="Corrects colors for color vision deficiency. Supports multiple layout modes with up to 4 zones."
                   Opacity="0.7" FontSize="12" TextWrapping="Wrap" Margin="0,4,0,0"/>

        <!-- Collapsible Content Panel -->
        <StackPanel x:Name="ContentPanel" Visibility="Collapsed" Margin="0,8,0,0">

            <!-- Layout Mode -->
            <TextBlock Text="Layout Mode" Style="{StaticResource SectionStyle}"/>

            <ComboBox x:Name="LayoutModeCombo" SelectionChanged="LayoutModeCombo_SelectionChanged" Margin="0,0,0,8">
                <ComboBoxItem Content="Fullscreen" IsSelected="True"/>
                <ComboBoxItem Content="Circle (around cursor)"/>
                <ComboBoxItem Content="Rectangle (around cursor)"/>
                <ComboBoxItem Content="Split Vertical (Left | Right)"/>
                <ComboBoxItem Content="Split Horizontal (Top | Bottom)"/>
                <ComboBoxItem Content="Quadrants (4 sections)"/>
            </ComboBox>

            <!-- Layout-Specific Settings -->

            <!-- Circle settings -->
            <StackPanel x:Name="CircleSettings" Visibility="Collapsed">
                <TextBlock Text="Radius (px)" Style="{StaticResource LabelStyle}"/>
                <Slider x:Name="RadiusSlider" Minimum="50" Maximum="1920" Value="300"
                        Style="{StaticResource SliderStyle}" ValueChanged="RadiusSlider_ValueChanged"/>
                <TextBlock x:Name="RadiusValue" Text="300" Opacity="0.7" FontSize="11"/>
            </StackPanel>

            <!-- Rectangle settings -->
            <StackPanel x:Name="RectangleSettings" Visibility="Collapsed">
                <TextBlock Text="Width (px)" Style="{StaticResource LabelStyle}"/>
                <Slider x:Name="RectWidthSlider" Minimum="100" Maximum="1920" Value="400"
                        Style="{StaticResource SliderStyle}" ValueChanged="RectWidthSlider_ValueChanged"/>
                <TextBlock x:Name="RectWidthValue" Text="400" Opacity="0.7" FontSize="11"/>

                <TextBlock Text="Height (px)" Style="{StaticResource LabelStyle}"/>
                <Slider x:Name="RectHeightSlider" Minimum="100" Maximum="1080" Value="300"
                        Style="{StaticResource SliderStyle}" ValueChanged="RectHeightSlider_ValueChanged"/>
                <TextBlock x:Name="RectHeightValue" Text="300" Opacity="0.7" FontSize="11"/>
            </StackPanel>

            <!-- Split Vertical settings -->
            <StackPanel x:Name="SplitVerticalSettings" Visibility="Collapsed">
                <TextBlock Text="Split Position" Style="{StaticResource LabelStyle}"/>
                <Slider x:Name="SplitPositionSlider" Minimum="0.1" Maximum="0.9" Value="0.5"
                        Style="{StaticResource SliderStyle}" ValueChanged="SplitPositionSlider_ValueChanged"/>
                <TextBlock x:Name="SplitPositionValue" Text="50%" Opacity="0.7" FontSize="11"/>
            </StackPanel>

            <!-- Split Horizontal settings -->
            <StackPanel x:Name="SplitHorizontalSettings" Visibility="Collapsed">
                <TextBlock Text="Split Position" Style="{StaticResource LabelStyle}"/>
                <Slider x:Name="SplitPositionHSlider" Minimum="0.1" Maximum="0.9" Value="0.5"
                        Style="{StaticResource SliderStyle}" ValueChanged="SplitPositionHSlider_ValueChanged"/>
                <TextBlock x:Name="SplitPositionHValue" Text="50%" Opacity="0.7" FontSize="11"/>
            </StackPanel>

            <!-- Quadrants settings -->
            <StackPanel x:Name="QuadrantSettings" Visibility="Collapsed">
                <TextBlock Text="Horizontal Split" Style="{StaticResource LabelStyle}"/>
                <Slider x:Name="QuadSplitHSlider" Minimum="0.1" Maximum="0.9" Value="0.5"
                        Style="{StaticResource SliderStyle}" ValueChanged="QuadSplitHSlider_ValueChanged"/>
                <TextBlock x:Name="QuadSplitHValue" Text="50%" Opacity="0.7" FontSize="11"/>

                <TextBlock Text="Vertical Split" Style="{StaticResource LabelStyle}"/>
                <Slider x:Name="QuadSplitVSlider" Minimum="0.1" Maximum="0.9" Value="0.5"
                        Style="{StaticResource SliderStyle}" ValueChanged="QuadSplitVSlider_ValueChanged"/>
                <TextBlock x:Name="QuadSplitVValue" Text="50%" Opacity="0.7" FontSize="11"/>
            </StackPanel>

            <!-- Edge Softness (shown for all modes except Fullscreen) -->
            <StackPanel x:Name="EdgeSoftnessPanel" Visibility="Collapsed">
                <TextBlock Text="Edge Softness" Style="{StaticResource LabelStyle}"/>
                <Slider x:Name="EdgeSoftnessSlider" Minimum="0" Maximum="1" Value="0.2"
                        Style="{StaticResource SliderStyle}" ValueChanged="EdgeSoftnessSlider_ValueChanged"/>
                <TextBlock x:Name="EdgeSoftnessValue" Text="0.20" Opacity="0.7" FontSize="11"/>
            </StackPanel>

            <!-- Comparison Mode (shown for Split and Quadrant modes) -->
            <StackPanel x:Name="ComparisonModePanel" Visibility="Collapsed" Margin="0,8,0,0">
                <CheckBox x:Name="ComparisonModeCheckBox" Content="Comparison Mode (copy screen to all zones)"
                          Checked="ComparisonModeCheckBox_Changed" Unchecked="ComparisonModeCheckBox_Changed"/>
                <CheckBox x:Name="EnableComparisonHotkeyCheckBox" Content="Enable hotkey (Alt+Shift+C)"
                          IsChecked="True" Margin="20,4,0,0"
                          Checked="EnableComparisonHotkeyCheckBox_Changed" Unchecked="EnableComparisonHotkeyCheckBox_Changed"/>
            </StackPanel>

            <Separator Margin="0,12,0,8"/>

            <!-- Zone Settings -->
            <TextBlock Text="Zone Settings" Style="{StaticResource SectionStyle}"/>

            <!-- Zone 0 -->
            <StackPanel x:Name="Zone0Panel">
                <TextBlock x:Name="Zone0Header" Text="Screen" Style="{StaticResource ZoneHeaderStyle}"/>

                <TextBlock Text="Correction Method" Style="{StaticResource LabelStyle}"/>
                <ComboBox x:Name="Zone0CorrectionModeCombo" SelectionChanged="Zone0CorrectionModeCombo_SelectionChanged" Margin="0,0,0,8">
                    <ComboBoxItem Content="LMS Correction (scientific)" IsSelected="True"/>
                    <ComboBoxItem Content="RGB Matrix (customizable)"/>
                </ComboBox>

                <!-- LMS Settings -->
                <StackPanel x:Name="Zone0LMSPanel">
                    <TextBlock Text="Filter Type" Style="{StaticResource LabelStyle}"/>
                    <ComboBox x:Name="Zone0LMSFilterCombo" SelectionChanged="Zone0LMSFilterCombo_SelectionChanged" Margin="0,0,0,8">
                        <ComboBoxItem Content="None" IsSelected="True"/>
                        <ComboBoxItem Content="Protanopia (Machado)"/>
                        <ComboBoxItem Content="Protanomaly (Machado)"/>
                        <ComboBoxItem Content="Deuteranopia (Machado)"/>
                        <ComboBoxItem Content="Deuteranomaly (Machado)"/>
                        <ComboBoxItem Content="Tritanopia (Machado)"/>
                        <ComboBoxItem Content="Tritanomaly (Machado)"/>
                        <ComboBoxItem Content="Protanopia (Strict)"/>
                        <ComboBoxItem Content="Protanomaly (Strict)"/>
                        <ComboBoxItem Content="Deuteranopia (Strict)"/>
                        <ComboBoxItem Content="Deuteranomaly (Strict)"/>
                        <ComboBoxItem Content="Tritanopia (Strict)"/>
                        <ComboBoxItem Content="Tritanomaly (Strict)"/>
                        <ComboBoxItem Content="Achromatopsia (monochromacy)"/>
                        <ComboBoxItem Content="Achromatomaly (weak color)"/>
                        <ComboBoxItem Content="Grayscale"/>
                        <ComboBoxItem Content="Inverted Grayscale"/>
                    </ComboBox>

                    <TextBlock Text="Mode" Style="{StaticResource LabelStyle}"/>
                    <ComboBox x:Name="Zone0ModeCombo" SelectionChanged="Zone0ModeCombo_SelectionChanged" Margin="0,0,0,8">
                        <ComboBoxItem Content="Correction (help colorblind users)" IsSelected="True"/>
                        <ComboBoxItem Content="Simulation (show what they see)"/>
                    </ComboBox>
                </StackPanel>

                <!-- RGB Settings -->
                <StackPanel x:Name="Zone0RGBPanel" Visibility="Collapsed">
                    <TextBlock Text="Load Preset" Style="{StaticResource LabelStyle}"/>
                    <ComboBox x:Name="Zone0RGBPresetCombo" SelectionChanged="Zone0RGBPresetCombo_SelectionChanged" Margin="0,0,0,8">
                        <ComboBoxItem Content="Normal Vision (Identity)" IsSelected="True"/>
                        <ComboBoxItem Content="Protanopia"/>
                        <ComboBoxItem Content="Protanomaly"/>
                        <ComboBoxItem Content="Deuteranopia"/>
                        <ComboBoxItem Content="Deuteranomaly"/>
                        <ComboBoxItem Content="Tritanopia"/>
                        <ComboBoxItem Content="Tritanomaly"/>
                        <ComboBoxItem Content="Achromatopsia"/>
                        <ComboBoxItem Content="Achromatomaly"/>
                        <ComboBoxItem Content="Grayscale"/>
                        <ComboBoxItem Content="Sepia"/>
                    </ComboBox>

                    <TextBlock Text="Color Matrix" Opacity="0.7" FontSize="11"/>
                    <Grid Margin="0,2">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="30"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="R" Foreground="#FFCC6666" VerticalAlignment="Center"/>
                        <TextBox x:Name="Zone0MatrixR0" Grid.Column="1" Text="1.000" Margin="2" TextChanged="Zone0Matrix_TextChanged"/>
                        <TextBox x:Name="Zone0MatrixR1" Grid.Column="2" Text="0.000" Margin="2" TextChanged="Zone0Matrix_TextChanged"/>
                        <TextBox x:Name="Zone0MatrixR2" Grid.Column="3" Text="0.000" Margin="2" TextChanged="Zone0Matrix_TextChanged"/>
                    </Grid>
                    <Grid Margin="0,2">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="30"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="G" Foreground="#FF66CC66" VerticalAlignment="Center"/>
                        <TextBox x:Name="Zone0MatrixG0" Grid.Column="1" Text="0.000" Margin="2" TextChanged="Zone0Matrix_TextChanged"/>
                        <TextBox x:Name="Zone0MatrixG1" Grid.Column="2" Text="1.000" Margin="2" TextChanged="Zone0Matrix_TextChanged"/>
                        <TextBox x:Name="Zone0MatrixG2" Grid.Column="3" Text="0.000" Margin="2" TextChanged="Zone0Matrix_TextChanged"/>
                    </Grid>
                    <Grid Margin="0,2">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="30"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="B" Foreground="#FF6666CC" VerticalAlignment="Center"/>
                        <TextBox x:Name="Zone0MatrixB0" Grid.Column="1" Text="0.000" Margin="2" TextChanged="Zone0Matrix_TextChanged"/>
                        <TextBox x:Name="Zone0MatrixB1" Grid.Column="2" Text="0.000" Margin="2" TextChanged="Zone0Matrix_TextChanged"/>
                        <TextBox x:Name="Zone0MatrixB2" Grid.Column="3" Text="1.000" Margin="2" TextChanged="Zone0Matrix_TextChanged"/>
                    </Grid>
                    <Button Content="Reset Matrix" Margin="0,4,0,0" Click="Zone0ResetMatrix_Click"/>
                </StackPanel>
            </StackPanel>

            <!-- Zone 1 -->
            <StackPanel x:Name="Zone1Panel" Visibility="Collapsed" Margin="0,8,0,0">
                <Separator Margin="0,4,0,8"/>
                <TextBlock x:Name="Zone1Header" Text="Zone 1" Style="{StaticResource ZoneHeaderStyle}"/>

                <TextBlock Text="Correction Method" Style="{StaticResource LabelStyle}"/>
                <ComboBox x:Name="Zone1CorrectionModeCombo" SelectionChanged="Zone1CorrectionModeCombo_SelectionChanged" Margin="0,0,0,8">
                    <ComboBoxItem Content="LMS Correction (scientific)" IsSelected="True"/>
                    <ComboBoxItem Content="RGB Matrix (customizable)"/>
                </ComboBox>

                <StackPanel x:Name="Zone1LMSPanel">
                    <TextBlock Text="Filter Type" Style="{StaticResource LabelStyle}"/>
                    <ComboBox x:Name="Zone1LMSFilterCombo" SelectionChanged="Zone1LMSFilterCombo_SelectionChanged" Margin="0,0,0,8">
                        <ComboBoxItem Content="None" IsSelected="True"/>
                        <ComboBoxItem Content="Protanopia (Machado)"/>
                        <ComboBoxItem Content="Protanomaly (Machado)"/>
                        <ComboBoxItem Content="Deuteranopia (Machado)"/>
                        <ComboBoxItem Content="Deuteranomaly (Machado)"/>
                        <ComboBoxItem Content="Tritanopia (Machado)"/>
                        <ComboBoxItem Content="Tritanomaly (Machado)"/>
                        <ComboBoxItem Content="Protanopia (Strict)"/>
                        <ComboBoxItem Content="Protanomaly (Strict)"/>
                        <ComboBoxItem Content="Deuteranopia (Strict)"/>
                        <ComboBoxItem Content="Deuteranomaly (Strict)"/>
                        <ComboBoxItem Content="Tritanopia (Strict)"/>
                        <ComboBoxItem Content="Tritanomaly (Strict)"/>
                        <ComboBoxItem Content="Achromatopsia (monochromacy)"/>
                        <ComboBoxItem Content="Achromatomaly (weak color)"/>
                        <ComboBoxItem Content="Grayscale"/>
                        <ComboBoxItem Content="Inverted Grayscale"/>
                    </ComboBox>

                    <TextBlock Text="Mode" Style="{StaticResource LabelStyle}"/>
                    <ComboBox x:Name="Zone1ModeCombo" SelectionChanged="Zone1ModeCombo_SelectionChanged" Margin="0,0,0,8">
                        <ComboBoxItem Content="Correction (help colorblind users)" IsSelected="True"/>
                        <ComboBoxItem Content="Simulation (show what they see)"/>
                    </ComboBox>
                </StackPanel>

                <StackPanel x:Name="Zone1RGBPanel" Visibility="Collapsed">
                    <TextBlock Text="Load Preset" Style="{StaticResource LabelStyle}"/>
                    <ComboBox x:Name="Zone1RGBPresetCombo" SelectionChanged="Zone1RGBPresetCombo_SelectionChanged" Margin="0,0,0,8">
                        <ComboBoxItem Content="Normal Vision (Identity)" IsSelected="True"/>
                        <ComboBoxItem Content="Protanopia"/>
                        <ComboBoxItem Content="Protanomaly"/>
                        <ComboBoxItem Content="Deuteranopia"/>
                        <ComboBoxItem Content="Deuteranomaly"/>
                        <ComboBoxItem Content="Tritanopia"/>
                        <ComboBoxItem Content="Tritanomaly"/>
                        <ComboBoxItem Content="Achromatopsia"/>
                        <ComboBoxItem Content="Achromatomaly"/>
                        <ComboBoxItem Content="Grayscale"/>
                        <ComboBoxItem Content="Sepia"/>
                    </ComboBox>

                    <TextBlock Text="Color Matrix" Opacity="0.7" FontSize="11"/>
                    <Grid Margin="0,2">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="30"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="R" Foreground="#FFCC6666" VerticalAlignment="Center"/>
                        <TextBox x:Name="Zone1MatrixR0" Grid.Column="1" Text="1.000" Margin="2" TextChanged="Zone1Matrix_TextChanged"/>
                        <TextBox x:Name="Zone1MatrixR1" Grid.Column="2" Text="0.000" Margin="2" TextChanged="Zone1Matrix_TextChanged"/>
                        <TextBox x:Name="Zone1MatrixR2" Grid.Column="3" Text="0.000" Margin="2" TextChanged="Zone1Matrix_TextChanged"/>
                    </Grid>
                    <Grid Margin="0,2">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="30"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="G" Foreground="#FF66CC66" VerticalAlignment="Center"/>
                        <TextBox x:Name="Zone1MatrixG0" Grid.Column="1" Text="0.000" Margin="2" TextChanged="Zone1Matrix_TextChanged"/>
                        <TextBox x:Name="Zone1MatrixG1" Grid.Column="2" Text="1.000" Margin="2" TextChanged="Zone1Matrix_TextChanged"/>
                        <TextBox x:Name="Zone1MatrixG2" Grid.Column="3" Text="0.000" Margin="2" TextChanged="Zone1Matrix_TextChanged"/>
                    </Grid>
                    <Grid Margin="0,2">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="30"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="B" Foreground="#FF6666CC" VerticalAlignment="Center"/>
                        <TextBox x:Name="Zone1MatrixB0" Grid.Column="1" Text="0.000" Margin="2" TextChanged="Zone1Matrix_TextChanged"/>
                        <TextBox x:Name="Zone1MatrixB1" Grid.Column="2" Text="0.000" Margin="2" TextChanged="Zone1Matrix_TextChanged"/>
                        <TextBox x:Name="Zone1MatrixB2" Grid.Column="3" Text="1.000" Margin="2" TextChanged="Zone1Matrix_TextChanged"/>
                    </Grid>
                    <Button Content="Reset Matrix" Margin="0,4,0,0" Click="Zone1ResetMatrix_Click"/>
                </StackPanel>
            </StackPanel>

            <!-- Zone 2 -->
            <StackPanel x:Name="Zone2Panel" Visibility="Collapsed" Margin="0,8,0,0">
                <Separator Margin="0,4,0,8"/>
                <TextBlock x:Name="Zone2Header" Text="Zone 2" Style="{StaticResource ZoneHeaderStyle}"/>

                <TextBlock Text="Correction Method" Style="{StaticResource LabelStyle}"/>
                <ComboBox x:Name="Zone2CorrectionModeCombo" SelectionChanged="Zone2CorrectionModeCombo_SelectionChanged" Margin="0,0,0,8">
                    <ComboBoxItem Content="LMS Correction (scientific)" IsSelected="True"/>
                    <ComboBoxItem Content="RGB Matrix (customizable)"/>
                </ComboBox>

                <StackPanel x:Name="Zone2LMSPanel">
                    <TextBlock Text="Filter Type" Style="{StaticResource LabelStyle}"/>
                    <ComboBox x:Name="Zone2LMSFilterCombo" SelectionChanged="Zone2LMSFilterCombo_SelectionChanged" Margin="0,0,0,8">
                        <ComboBoxItem Content="None" IsSelected="True"/>
                        <ComboBoxItem Content="Protanopia (Machado)"/>
                        <ComboBoxItem Content="Protanomaly (Machado)"/>
                        <ComboBoxItem Content="Deuteranopia (Machado)"/>
                        <ComboBoxItem Content="Deuteranomaly (Machado)"/>
                        <ComboBoxItem Content="Tritanopia (Machado)"/>
                        <ComboBoxItem Content="Tritanomaly (Machado)"/>
                        <ComboBoxItem Content="Protanopia (Strict)"/>
                        <ComboBoxItem Content="Protanomaly (Strict)"/>
                        <ComboBoxItem Content="Deuteranopia (Strict)"/>
                        <ComboBoxItem Content="Deuteranomaly (Strict)"/>
                        <ComboBoxItem Content="Tritanopia (Strict)"/>
                        <ComboBoxItem Content="Tritanomaly (Strict)"/>
                        <ComboBoxItem Content="Achromatopsia (monochromacy)"/>
                        <ComboBoxItem Content="Achromatomaly (weak color)"/>
                        <ComboBoxItem Content="Grayscale"/>
                        <ComboBoxItem Content="Inverted Grayscale"/>
                    </ComboBox>

                    <TextBlock Text="Mode" Style="{StaticResource LabelStyle}"/>
                    <ComboBox x:Name="Zone2ModeCombo" SelectionChanged="Zone2ModeCombo_SelectionChanged" Margin="0,0,0,8">
                        <ComboBoxItem Content="Correction (help colorblind users)" IsSelected="True"/>
                        <ComboBoxItem Content="Simulation (show what they see)"/>
                    </ComboBox>
                </StackPanel>

                <StackPanel x:Name="Zone2RGBPanel" Visibility="Collapsed">
                    <TextBlock Text="Load Preset" Style="{StaticResource LabelStyle}"/>
                    <ComboBox x:Name="Zone2RGBPresetCombo" SelectionChanged="Zone2RGBPresetCombo_SelectionChanged" Margin="0,0,0,8">
                        <ComboBoxItem Content="Normal Vision (Identity)" IsSelected="True"/>
                        <ComboBoxItem Content="Protanopia"/>
                        <ComboBoxItem Content="Protanomaly"/>
                        <ComboBoxItem Content="Deuteranopia"/>
                        <ComboBoxItem Content="Deuteranomaly"/>
                        <ComboBoxItem Content="Tritanopia"/>
                        <ComboBoxItem Content="Tritanomaly"/>
                        <ComboBoxItem Content="Achromatopsia"/>
                        <ComboBoxItem Content="Achromatomaly"/>
                        <ComboBoxItem Content="Grayscale"/>
                        <ComboBoxItem Content="Sepia"/>
                    </ComboBox>

                    <TextBlock Text="Color Matrix" Opacity="0.7" FontSize="11"/>
                    <Grid Margin="0,2">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="30"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="R" Foreground="#FFCC6666" VerticalAlignment="Center"/>
                        <TextBox x:Name="Zone2MatrixR0" Grid.Column="1" Text="1.000" Margin="2" TextChanged="Zone2Matrix_TextChanged"/>
                        <TextBox x:Name="Zone2MatrixR1" Grid.Column="2" Text="0.000" Margin="2" TextChanged="Zone2Matrix_TextChanged"/>
                        <TextBox x:Name="Zone2MatrixR2" Grid.Column="3" Text="0.000" Margin="2" TextChanged="Zone2Matrix_TextChanged"/>
                    </Grid>
                    <Grid Margin="0,2">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="30"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="G" Foreground="#FF66CC66" VerticalAlignment="Center"/>
                        <TextBox x:Name="Zone2MatrixG0" Grid.Column="1" Text="0.000" Margin="2" TextChanged="Zone2Matrix_TextChanged"/>
                        <TextBox x:Name="Zone2MatrixG1" Grid.Column="2" Text="1.000" Margin="2" TextChanged="Zone2Matrix_TextChanged"/>
                        <TextBox x:Name="Zone2MatrixG2" Grid.Column="3" Text="0.000" Margin="2" TextChanged="Zone2Matrix_TextChanged"/>
                    </Grid>
                    <Grid Margin="0,2">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="30"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="B" Foreground="#FF6666CC" VerticalAlignment="Center"/>
                        <TextBox x:Name="Zone2MatrixB0" Grid.Column="1" Text="0.000" Margin="2" TextChanged="Zone2Matrix_TextChanged"/>
                        <TextBox x:Name="Zone2MatrixB1" Grid.Column="2" Text="0.000" Margin="2" TextChanged="Zone2Matrix_TextChanged"/>
                        <TextBox x:Name="Zone2MatrixB2" Grid.Column="3" Text="1.000" Margin="2" TextChanged="Zone2Matrix_TextChanged"/>
                    </Grid>
                    <Button Content="Reset Matrix" Margin="0,4,0,0" Click="Zone2ResetMatrix_Click"/>
                </StackPanel>
            </StackPanel>

            <!-- Zone 3 -->
            <StackPanel x:Name="Zone3Panel" Visibility="Collapsed" Margin="0,8,0,0">
                <Separator Margin="0,4,0,8"/>
                <TextBlock x:Name="Zone3Header" Text="Zone 3" Style="{StaticResource ZoneHeaderStyle}"/>

                <TextBlock Text="Correction Method" Style="{StaticResource LabelStyle}"/>
                <ComboBox x:Name="Zone3CorrectionModeCombo" SelectionChanged="Zone3CorrectionModeCombo_SelectionChanged" Margin="0,0,0,8">
                    <ComboBoxItem Content="LMS Correction (scientific)" IsSelected="True"/>
                    <ComboBoxItem Content="RGB Matrix (customizable)"/>
                </ComboBox>

                <StackPanel x:Name="Zone3LMSPanel">
                    <TextBlock Text="Filter Type" Style="{StaticResource LabelStyle}"/>
                    <ComboBox x:Name="Zone3LMSFilterCombo" SelectionChanged="Zone3LMSFilterCombo_SelectionChanged" Margin="0,0,0,8">
                        <ComboBoxItem Content="None" IsSelected="True"/>
                        <ComboBoxItem Content="Protanopia (Machado)"/>
                        <ComboBoxItem Content="Protanomaly (Machado)"/>
                        <ComboBoxItem Content="Deuteranopia (Machado)"/>
                        <ComboBoxItem Content="Deuteranomaly (Machado)"/>
                        <ComboBoxItem Content="Tritanopia (Machado)"/>
                        <ComboBoxItem Content="Tritanomaly (Machado)"/>
                        <ComboBoxItem Content="Protanopia (Strict)"/>
                        <ComboBoxItem Content="Protanomaly (Strict)"/>
                        <ComboBoxItem Content="Deuteranopia (Strict)"/>
                        <ComboBoxItem Content="Deuteranomaly (Strict)"/>
                        <ComboBoxItem Content="Tritanopia (Strict)"/>
                        <ComboBoxItem Content="Tritanomaly (Strict)"/>
                        <ComboBoxItem Content="Achromatopsia (monochromacy)"/>
                        <ComboBoxItem Content="Achromatomaly (weak color)"/>
                        <ComboBoxItem Content="Grayscale"/>
                        <ComboBoxItem Content="Inverted Grayscale"/>
                    </ComboBox>

                    <TextBlock Text="Mode" Style="{StaticResource LabelStyle}"/>
                    <ComboBox x:Name="Zone3ModeCombo" SelectionChanged="Zone3ModeCombo_SelectionChanged" Margin="0,0,0,8">
                        <ComboBoxItem Content="Correction (help colorblind users)" IsSelected="True"/>
                        <ComboBoxItem Content="Simulation (show what they see)"/>
                    </ComboBox>
                </StackPanel>

                <StackPanel x:Name="Zone3RGBPanel" Visibility="Collapsed">
                    <TextBlock Text="Load Preset" Style="{StaticResource LabelStyle}"/>
                    <ComboBox x:Name="Zone3RGBPresetCombo" SelectionChanged="Zone3RGBPresetCombo_SelectionChanged" Margin="0,0,0,8">
                        <ComboBoxItem Content="Normal Vision (Identity)" IsSelected="True"/>
                        <ComboBoxItem Content="Protanopia"/>
                        <ComboBoxItem Content="Protanomaly"/>
                        <ComboBoxItem Content="Deuteranopia"/>
                        <ComboBoxItem Content="Deuteranomaly"/>
                        <ComboBoxItem Content="Tritanopia"/>
                        <ComboBoxItem Content="Tritanomaly"/>
                        <ComboBoxItem Content="Achromatopsia"/>
                        <ComboBoxItem Content="Achromatomaly"/>
                        <ComboBoxItem Content="Grayscale"/>
                        <ComboBoxItem Content="Sepia"/>
                    </ComboBox>

                    <TextBlock Text="Color Matrix" Opacity="0.7" FontSize="11"/>
                    <Grid Margin="0,2">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="30"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="R" Foreground="#FFCC6666" VerticalAlignment="Center"/>
                        <TextBox x:Name="Zone3MatrixR0" Grid.Column="1" Text="1.000" Margin="2" TextChanged="Zone3Matrix_TextChanged"/>
                        <TextBox x:Name="Zone3MatrixR1" Grid.Column="2" Text="0.000" Margin="2" TextChanged="Zone3Matrix_TextChanged"/>
                        <TextBox x:Name="Zone3MatrixR2" Grid.Column="3" Text="0.000" Margin="2" TextChanged="Zone3Matrix_TextChanged"/>
                    </Grid>
                    <Grid Margin="0,2">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="30"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="G" Foreground="#FF66CC66" VerticalAlignment="Center"/>
                        <TextBox x:Name="Zone3MatrixG0" Grid.Column="1" Text="0.000" Margin="2" TextChanged="Zone3Matrix_TextChanged"/>
                        <TextBox x:Name="Zone3MatrixG1" Grid.Column="2" Text="1.000" Margin="2" TextChanged="Zone3Matrix_TextChanged"/>
                        <TextBox x:Name="Zone3MatrixG2" Grid.Column="3" Text="0.000" Margin="2" TextChanged="Zone3Matrix_TextChanged"/>
                    </Grid>
                    <Grid Margin="0,2">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="30"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="B" Foreground="#FF6666CC" VerticalAlignment="Center"/>
                        <TextBox x:Name="Zone3MatrixB0" Grid.Column="1" Text="0.000" Margin="2" TextChanged="Zone3Matrix_TextChanged"/>
                        <TextBox x:Name="Zone3MatrixB1" Grid.Column="2" Text="0.000" Margin="2" TextChanged="Zone3Matrix_TextChanged"/>
                        <TextBox x:Name="Zone3MatrixB2" Grid.Column="3" Text="1.000" Margin="2" TextChanged="Zone3Matrix_TextChanged"/>
                    </Grid>
                    <Button Content="Reset Matrix" Margin="0,4,0,0" Click="Zone3ResetMatrix_Click"/>
                </StackPanel>
            </StackPanel>

            <Separator Margin="0,12,0,8"/>

            <!-- Common Settings -->
            <TextBlock Text="Adjustment" Style="{StaticResource SectionStyle}"/>

            <TextBlock Text="Intensity" Style="{StaticResource LabelStyle}"/>
            <Slider x:Name="IntensitySlider" Minimum="0" Maximum="1" Value="1"
                    Style="{StaticResource SliderStyle}" ValueChanged="IntensitySlider_ValueChanged"/>
            <TextBlock x:Name="IntensityValue" Text="1.00" Opacity="0.7" FontSize="11"/>

            <TextBlock Text="Color Boost (Saturation)" Style="{StaticResource LabelStyle}"/>
            <Slider x:Name="ColorBoostSlider" Minimum="0" Maximum="2" Value="1"
                    Style="{StaticResource SliderStyle}" ValueChanged="ColorBoostSlider_ValueChanged"/>
            <TextBlock x:Name="ColorBoostValue" Text="1.00" Opacity="0.7" FontSize="11"/>

            <Separator Margin="0,12,0,8"/>

            <!-- RGB Curves -->
            <TextBlock Text="RGB Curves" Style="{StaticResource SectionStyle}"/>

            <CheckBox x:Name="EnableCurvesCheckBox" Content="Enable RGB Curves" Margin="0,0,0,8"
                      IsChecked="False" Checked="EnableCurvesCheckBox_Changed" Unchecked="EnableCurvesCheckBox_Changed"/>

            <StackPanel x:Name="CurvesPanel">
                <TextBlock Text="Curve Strength" Style="{StaticResource LabelStyle}"/>
                <Slider x:Name="CurveStrengthSlider" Minimum="0" Maximum="1" Value="1"
                        Style="{StaticResource SliderStyle}" ValueChanged="CurveStrengthSlider_ValueChanged"/>
                <TextBlock x:Name="CurveStrengthValue" Text="1.00" Opacity="0.7" FontSize="11"/>

                <!-- Curve Editor -->
                <local:CurveEditor x:Name="CurveEditorControl" Height="200" Margin="0,8,0,0"
                                   CurveChanged="CurveEditorControl_CurveChanged"/>
            </StackPanel>

        </StackPanel>
    </StackPanel>
</UserControl>
